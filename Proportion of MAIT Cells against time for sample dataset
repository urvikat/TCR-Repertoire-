MAIT_and_original_TCR_sample <- merge(total_TCR_alpha2,Mait_total_TCR_sample,by=c('ID','tp_week'))    #table with number of TCR from original data and MAIT TCR
MAIT_proportions_of_original_sample <- mutate(MAIT_and_original_TCR_sample, proportion = junction_aa.y/junction_aa.x)  #table with proportions of original TCR that are MAIT, for each ID at  all timepoints
library(ggplot2)
ggplot(MAIT_proportions_of_original_sample, aes(x = as.numeric(tp_week), y=proportion)) +     #plot of proportion of TCR of original data that are MAIT cells over time, for each ID
  geom_point() +
  geom_line(
    mapping = aes(x=as.numeric(tp_week), y=proportion,
                  group=ID,
                  colour=ID)
  ) +
  labs(title="Proportions of TCR-alpha from the Sample Dataset that are MAIT Cells",x="Timepoint(Week)",y="Proportion of MAIT Cells")

sorted_ID_MAIT_prop_sample <- MAIT_proportions_of_original_sample[order(MAIT_proportions_of_original_sample$ID),]
#ID of proportions of original of Mait cells in the sample
ID35_sample <- which(sorted_ID_MAIT_prop_sample$ID==35)
ID36_sample <- which(sorted_ID_MAIT_prop_sample$ID==36)
ID55_sample <- which(sorted_ID_MAIT_prop_sample$ID==55)
ID69_sample <- which(sorted_ID_MAIT_prop_sample$ID==69)
ID77_sample <- which(sorted_ID_MAIT_prop_sample$ID==77)
ID79_sample <- which(sorted_ID_MAIT_prop_sample$ID==79)
ID81_sample <- which(sorted_ID_MAIT_prop_sample$ID==81)
ID90_sample <- which(sorted_ID_MAIT_prop_sample$ID==90)


MAIT_TCR_35_sample <-sorted_ID_MAIT_prop_sample[ID35_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_35_sample <- mutate(MAIT_TCR_35_sample, variance=var(proportion)) #calculating variance across all tp for ID 35 and adding a column

MAIT_TCR_36_sample <-sorted_ID_MAIT_prop_sample[ID36_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_36_sample <- mutate(MAIT_TCR_36_sample, variance=var(proportion)) #calculating variance across all tp for ID 36 and adding a column


MAIT_TCR_55_sample <-sorted_ID_MAIT_prop_sample[ID55_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_55_sample <- mutate(MAIT_TCR_55_sample, variance=var(proportion)) #calculating variance across all tp for ID 55 and adding a column


MAIT_TCR_69_sample <-sorted_ID_MAIT_prop_sample[ID69_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_69_sample <- mutate(MAIT_TCR_69_sample, variance=var(proportion)) #calculating variance across all tp for ID 69 and adding a column


MAIT_TCR_77_sample <-sorted_ID_MAIT_prop_sample[ID77_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_77_sample <- mutate(MAIT_TCR_77_sample, variance=var(proportion)) #calculating variance across all tp for ID 77 and adding a column

MAIT_TCR_79_sample <-sorted_ID_MAIT_prop_sample[ID79_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_79_sample <- mutate(MAIT_TCR_79_sample, variance=var(proportion)) #calculating variance across all tp for ID 79 and adding a column

MAIT_TCR_81_sample <-sorted_ID_MAIT_prop_sample[ID81_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_81_sample <- mutate(MAIT_TCR_81_sample, variance=var(proportion)) #calculating variance across all tp for ID 81 and adding a column

MAIT_TCR_90_sample <-sorted_ID_MAIT_prop_sample[ID90_sample,] #presents these rows of IDs from data of proportions of MAIT TCRs of original in sample
var_TCR_90_sample <- mutate(MAIT_TCR_90_sample, variance=var(proportion)) #calculating variance across all tp for ID 90 and adding a column

Var_sample_MAIT <- rbind(var_TCR_35_sample,var_TCR_36_sample,var_TCR_55_sample,var_TCR_69_sample,var_TCR_77_sample,var_TCR_79_sample,var_TCR_79_sample,var_TCR_81_sample,var_TCR_90_sample) #binding rows of sample MAIT TCR with variances
